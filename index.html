<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'unsafe-inline'; style-src 'unsafe-inline';">

    <title>ç·šä¸ŠåŠ è§£å¯†å·¥å…· | Online Text Encryption & Decryption (AES-GCM-256)</title>

    <meta name="description" content="å°ˆæ¥­ç·šä¸Šæ–‡å­—åŠ è§£å¯†å·¥å…·ã€‚æ¡ç”¨ AES-GCM-256 é«˜å¼·åº¦æ¼”ç®—æ³•ï¼Œæ‰€æœ‰åŠ è§£å¯†ç¨‹åºçš†åœ¨ç€è¦½å™¨æœ¬åœ°å®Œæˆï¼Œæ‚¨çš„æ•æ„Ÿæ•¸æ“šçµ•ä¸å‚³è¼¸è‡³ä¼ºæœå™¨ï¼Œç¢ºä¿ 100% éš±ç§ã€‚">
    <meta name="keywords" content="ç·šä¸ŠåŠ å¯†, ç·šä¸Šè§£å¯†, æ–‡å­—åŠ å¯†, AES-256-GCM, éš±ç§ä¿è­·, Online Encryption, AES Vault">
    <meta name="author" content="mike-hsieh-tw">

    <meta property="og:title" content="ç·šä¸ŠåŠ è§£å¯†å·¥å…· - AES Vault (AES-GCM-256)">
    <meta property="og:description" content="ç¢ºä¿éš±ç§çš„æœ¬åœ°åŒ–åŠ è§£å¯†å·¥å…·ï¼Œæ•¸æ“šä¸é›¢é–‹ç™¼é€ç«¯ï¼Œå®‰å…¨å¯é ã€‚">
    <meta property="og:url" content="https://mike-hsieh-tw.github.io/aes-vault/">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="AES Vault">

    <link rel="canonical" href="https://mike-hsieh-tw.github.io/aes-vault/">
    
    <!-- Favicon (SVG inline, zero dependencies) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='30' y='45' width='40' height='35' rx='5' fill='%23ff6b35' stroke='%23e8491d' stroke-width='3'/><path d='M35 45 V35 Q35 20 50 20 Q65 20 65 35 V45' fill='none' stroke='%23e8491d' stroke-width='5' stroke-linecap='round'/><circle cx='50' cy='62' r='4' fill='%23fff'/><rect x='48' y='62' width='4' height='10' rx='1' fill='%23fff'/></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .subtitle {
            font-size: 0.95em;
            opacity: 0.9;
        }

        .security-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.85em;
        }

        /* èªè¨€åˆ‡æ›æŒ‰éˆ• */
        .lang-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            background: rgba(255,255,255,0.25);
            padding: 8px 12px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }

        .lang-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            padding: 5px 10px;
            border-radius: 15px;
            transition: all 0.3s;
            opacity: 0.7;
        }

        .lang-btn:hover {
            opacity: 1;
            background: rgba(255,255,255,0.2);
        }

        .lang-btn.active {
            opacity: 1;
            background: rgba(255,255,255,0.35);
            font-weight: 600;
        }

        .main-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            margin-bottom: 20px;
        }

        /* æ¨¡å¼åˆ‡æ› Tab */
        .mode-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
        }

        .mode-tab {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            font-size: 1.1em;
            font-weight: 600;
            color: #999;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            position: relative;
            bottom: -2px;
        }

        .mode-tab:hover {
            color: #667eea;
        }

        .mode-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .mode-tab .icon {
            font-size: 1.2em;
            margin-right: 8px;
        }

        /* è¡¨å–®å€åŸŸ */
        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 0.95em;
        }

        textarea, input[type="password"], input[type="text"] {
            width: 100%;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            font-family: 'Courier New', monospace;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: sans-serif;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
            line-height: 1.5;
            font-family: sans-serif;
        }

        textarea:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .password-wrapper {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #667eea;
            cursor: pointer;
            font-size: 0.9em;
            padding: 5px 10px;
            font-weight: 500;
        }

        .toggle-password:hover {
            color: #764ba2;
        }

        .password-strength {
            margin-top: 8px;
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0%;
            transition: width 0.3s, background-color 0.3s;
        }

        .strength-weak { background-color: #f44336; width: 33%; }
        .strength-medium { background-color: #ff9800; width: 66%; }
        .strength-strong { background-color: #4caf50; width: 100%; }

        .password-hint {
            font-size: 0.85em;
            color: #888;
            margin-top: 6px;
        }

        /* æŒ‰éˆ• */
        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
        }

        button {
            padding: 14px 28px;
            font-size: 1em;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
            min-width: 100px;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        .btn-success:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(76, 175, 80, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        button:active:not(:disabled) {
            transform: translateY(0px);
        }

        /* è¼¸å‡ºå€åŸŸ */
        .output-section {
            margin-top: 30px;
        }

        .output-area {
            background: #f9f9f9;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 18px;
            min-height: 100px;
            font-family: sans-serif;
            font-size: 0.95em;
            word-break: break-all;
            white-space: pre-wrap;
            line-height: 1.6;
            color: #333;
        }

        .output-area.empty {
            color: #999;
            font-style: italic;
        }

        .output-area.success {
            background: #e8f5e9;
            border-color: #4caf50;
            color: #2e7d32;
        }

        .output-area.error {
            background: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }

        /* Loading å‹•ç•« */
        .loading {
            display: none;
            text-align: center;
            padding: 30px 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: #667eea;
            font-weight: 500;
        }

        /* è³‡è¨Šæ¡† */
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 18px;
            border-radius: 5px;
            margin-top: 30px;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .info-box strong {
            display: block;
            margin-bottom: 8px;
            color: #1976d2;
        }

        /* Footer */
        .footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            font-size: 0.85em;
            opacity: 0.85;
            line-height: 1.6;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .main-card {
                padding: 25px;
            }

            .header h1 {
                font-size: 2em;
            }

            .header .subtitle {
                font-size: 0.85em;
            }

            .mode-tab {
                font-size: 1em;
                padding: 12px;
            }

            textarea {
                min-height: 120px;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
		
		/* Footer åŸºç¤æ¨£å¼å¾®èª¿ */
		.footer {
			text-align: center;
			color: white;
			margin-top: 30px;
			font-size: 0.85em;
			opacity: 0.85;
			line-height: 1.8;
		}

		/* æ–°å¢ï¼šPowered by é€£çµæ¨£å¼ */
		.powered-by {
			margin-top: 15px;
			font-weight: 500;
		}

		.powered-by a {
			color: #fff;
			text-decoration: none;
			border-bottom: 1px solid rgba(255,255,255,0.4);
			padding-bottom: 2px;
			transition: all 0.3s ease;
		}

		.powered-by a:hover {
			opacity: 1;
			border-bottom-color: #fff;
			text-shadow: 0 0 8px rgba(255,255,255,0.5);
		}
    </style>
</head>
<body>
    <!-- èªè¨€åˆ‡æ›æŒ‰éˆ• -->
    <div class="lang-switcher">
        <button class="lang-btn active" onclick="switchLanguage('zh-TW')" id="lang-zh">ç¹ä¸­</button>
        <button class="lang-btn" onclick="switchLanguage('en')" id="lang-en">EN</button>
    </div>

    <div class="container">
        <div class="header">
            <h1 data-i18n="title">ğŸ” é«˜å®‰å…¨æ€§åŠ è§£å¯†å·¥å…·</h1>
            <div class="subtitle" data-i18n="subtitle">AES-GCM-256 + PBKDF2-SHA512 (600k iterations) + HKDF</div>
            <div class="security-badge" data-i18n="securityBadge">âœ“ é›¶å¤–éƒ¨ä¾è³´ | âœ“ å®Œå…¨é›¢ç·š | âœ“ å®¢æˆ¶ç«¯åŠ å¯†</div>
        </div>

        <div class="main-card">
            <!-- æ¨¡å¼åˆ‡æ› Tab -->
            <div class="mode-tabs">
                <button class="mode-tab active" onclick="switchMode('encrypt')" id="encrypt-tab">
                    <span class="icon">ğŸ”’</span><span data-i18n="encryptTab">åŠ å¯†</span>
                </button>
                <button class="mode-tab" onclick="switchMode('decrypt')" id="decrypt-tab">
                    <span class="icon">ğŸ”“</span><span data-i18n="decryptTab">è§£å¯†</span>
                </button>
            </div>

            <!-- è¼¸å…¥å…§å®¹å€ -->
            <div class="form-group">
                <label for="content-input" id="content-label" data-i18n="contentLabel">è¼¸å…¥å…§å®¹</label>
                <textarea id="content-input" data-i18n-placeholder="contentPlaceholder" placeholder="è«‹è¼¸å…¥è¦åŠ å¯†çš„å…§å®¹..."></textarea>
            </div>

            <!-- å¯†ç¢¼è¼¸å…¥å€ -->
            <div class="form-group">
                <label for="password-input" data-i18n="passwordLabel">å¯†ç¢¼</label>
                <div class="password-wrapper">
                    <input type="password" id="password-input" data-i18n-placeholder="passwordPlaceholder" placeholder="è¼¸å…¥å¼·å¯†ç¢¼ï¼ˆå»ºè­°16å­—å…ƒä»¥ä¸Šï¼‰">
                    <button type="button" class="toggle-password" onclick="togglePassword()" id="toggle-password-btn" data-i18n="togglePasswordShow">é¡¯ç¤º</button>
                </div>
                <div class="password-strength">
                    <div id="password-strength-bar" class="password-strength-bar"></div>
                </div>
                <div class="password-hint" id="password-hint" data-i18n="passwordHint">å»ºè­°ï¼šè‡³å°‘12å­—å…ƒï¼ŒåŒ…å«å¤§å°å¯«ã€æ•¸å­—ã€ç‰¹æ®Šç¬¦è™Ÿ</div>
            </div>

            <!-- æ“ä½œæŒ‰éˆ• -->
            <div class="button-group">
                <button class="btn-primary" onclick="processAction()" id="action-button" data-i18n="actionButtonEncrypt">
                    ğŸ”’ åŠ å¯†
                </button>
                <button class="btn-secondary" onclick="clearAll()" data-i18n="clearButton">æ¸…é™¤</button>
            </div>

            <!-- Loading å‹•ç•« -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div class="loading-text" id="loading-text" data-i18n="loadingText">è™•ç†ä¸­ï¼Œè«‹ç¨å€™...</div>
            </div>

            <!-- çµæœè¼¸å‡ºå€ -->
            <div class="output-section" id="output-section" style="display: none;">
                <div class="form-group">
                    <label id="output-label" data-i18n="outputLabel">çµæœ</label>
                    <div id="output" class="output-area empty" data-i18n="outputEmpty">çµæœå°‡é¡¯ç¤ºåœ¨é€™è£¡...</div>
                    <div class="button-group" style="margin-top: 12px;">
                        <button class="btn-success" onclick="copyToClipboard()" data-i18n="copyButton">ğŸ“‹ è¤‡è£½çµæœ</button>
                    </div>
                </div>
            </div>

            <!-- è³‡è¨Šèªªæ˜ -->
            <div class="info-box">
                <strong data-i18n="infoTitle">âš ï¸ å®‰å…¨æç¤º</strong>
                <div data-i18n-html="infoContent">
                    â€¢ æ‰€æœ‰åŠ å¯†è™•ç†å®Œå…¨åœ¨æ‚¨çš„ç€è¦½å™¨æœ¬åœ°å®Œæˆï¼Œä¸æœƒä¸Šå‚³åˆ°ä»»ä½•ä¼ºæœå™¨<br>
                    â€¢ è«‹å¦¥å–„ä¿ç®¡æ‚¨çš„å¯†ç¢¼ï¼Œéºå¤±å¯†ç¢¼å°‡ç„¡æ³•å¾©åŸè³‡æ–™<br>
                    â€¢ æ­¤å·¥å…·ä½¿ç”¨ AES-GCM-256 ä½å…ƒåŠ å¯†ï¼ŒPBKDF2-SHA512 (600,000 æ¬¡è¿­ä»£) é‡‘é‘°è¡ç”Ÿ<br>
                    â€¢ å»ºè­°ä½¿ç”¨å¼·å¯†ç¢¼ä»¥ç²å¾—æœ€ä½³å®‰å…¨æ€§
                </div>
            </div>
        </div>

        <div class="footer">
			<p data-i18n="footerLine1">100% åŸç”Ÿ JavaScript å¯¦ä½œ | é›¶å¤–éƒ¨ä¾è³´ | é–‹æºå¯å¯©è¨ˆ</p>
			<p>Version 1.0 | AES-GCM-256 | PBKDF2-SHA512 | HKDF-SHA256</p>
			<p class="powered-by">Powered by <a href="https://github.com/mike-hsieh-tw/aes-vault/" target="_blank">mike.hsieh</a></p>
		</div>
    </div>

    <script>
        'use strict';

        // ============================================
        // å¤šèªè¨€ç¿»è­¯å°è±¡
        // ============================================
        const translations = {
            'zh-TW': {
                title: 'ğŸ” é«˜å®‰å…¨æ€§åŠ è§£å¯†å·¥å…·',
                subtitle: 'AES-GCM-256 + PBKDF2-SHA512 (600k iterations) + HKDF',
                securityBadge: 'âœ“ é›¶å¤–éƒ¨ä¾è³´ | âœ“ å®Œå…¨é›¢ç·š | âœ“ å®¢æˆ¶ç«¯åŠ å¯†',
                encryptTab: 'åŠ å¯†',
                decryptTab: 'è§£å¯†',
                contentLabel: 'è¼¸å…¥å…§å®¹',
                contentPlaceholder: 'è«‹è¼¸å…¥è¦åŠ å¯†çš„å…§å®¹...',
                contentPlaceholderDecrypt: 'è«‹è²¼ä¸Šè¦è§£å¯†çš„å¯†æ–‡...',
                passwordLabel: 'å¯†ç¢¼',
                passwordPlaceholder: 'è¼¸å…¥å¼·å¯†ç¢¼ï¼ˆå»ºè­°16å­—å…ƒä»¥ä¸Šï¼‰',
                togglePasswordShow: 'é¡¯ç¤º',
                togglePasswordHide: 'éš±è—',
                passwordHint: 'å»ºè­°ï¼šè‡³å°‘12å­—å…ƒï¼ŒåŒ…å«å¤§å°å¯«ã€æ•¸å­—ã€ç‰¹æ®Šç¬¦è™Ÿ',
                passwordHintDecrypt: 'è«‹è¼¸å…¥åŠ å¯†æ™‚ä½¿ç”¨çš„å¯†ç¢¼',
                actionButtonEncrypt: 'ğŸ”’ åŠ å¯†',
                actionButtonDecrypt: 'ğŸ”“ è§£å¯†',
                clearButton: 'æ¸…é™¤',
                loadingText: 'è™•ç†ä¸­ï¼Œè«‹ç¨å€™...',
                loadingTextEncrypt: 'åŠ å¯†è™•ç†ä¸­ï¼Œè«‹ç¨å€™...',
                loadingTextDecrypt: 'è§£å¯†è™•ç†ä¸­ï¼Œè«‹ç¨å€™...',
                outputLabel: 'çµæœ',
                outputLabelEncrypt: 'åŠ å¯†çµæœ',
                outputLabelDecrypt: 'è§£å¯†çµæœ',
                outputLabelError: 'éŒ¯èª¤',
                outputEmpty: 'çµæœå°‡é¡¯ç¤ºåœ¨é€™è£¡...',
                copyButton: 'ğŸ“‹ è¤‡è£½çµæœ',
                infoTitle: 'âš ï¸ å®‰å…¨æç¤º',
                infoContent: 'â€¢ æ‰€æœ‰åŠ å¯†è™•ç†å®Œå…¨åœ¨æ‚¨çš„ç€è¦½å™¨æœ¬åœ°å®Œæˆï¼Œä¸æœƒä¸Šå‚³åˆ°ä»»ä½•ä¼ºæœå™¨<br>â€¢ è«‹å¦¥å–„ä¿ç®¡æ‚¨çš„å¯†ç¢¼ï¼Œéºå¤±å¯†ç¢¼å°‡ç„¡æ³•å¾©åŸè³‡æ–™<br>â€¢ æ­¤å·¥å…·ä½¿ç”¨ AES-GCM-256 ä½å…ƒåŠ å¯†ï¼ŒPBKDF2-SHA512 (600,000 æ¬¡è¿­ä»£) é‡‘é‘°è¡ç”Ÿ<br>â€¢ å»ºè­°ä½¿ç”¨å¼·å¯†ç¢¼ä»¥ç²å¾—æœ€ä½³å®‰å…¨æ€§',
                footerLine1: '100% åŸç”Ÿ JavaScript å¯¦ä½œ | é›¶å¤–éƒ¨ä¾è³´ | é–‹æºå¯å¯©è¨ˆ',
                // éŒ¯èª¤è¨Šæ¯
                errorNoContent: 'è«‹è¼¸å…¥è¦åŠ å¯†çš„å…§å®¹',
                errorNoCiphertext: 'è«‹è¼¸å…¥è¦è§£å¯†çš„å¯†æ–‡',
                errorNoPassword: 'è«‹è¼¸å…¥å¯†ç¢¼',
                errorPasswordTooShort: 'å¯†ç¢¼é•·åº¦è‡³å°‘éœ€è¦ 8 å€‹å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ 16 å­—å…ƒä»¥ä¸Šçš„å¼·å¯†ç¢¼',
                errorEncryptionFailed: 'åŠ å¯†éç¨‹ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥æ‚¨çš„è¼¸å…¥',
                errorInvalidFormat: 'ç„¡æ•ˆçš„å¯†æ–‡æ ¼å¼',
                errorDecryptionFailed: 'è§£å¯†å¤±æ•—ï¼šå¯†ç¢¼éŒ¯èª¤æˆ–å¯†æ–‡å·²æå£',
                errorInvalidCiphertext: 'å¯†æ–‡æ ¼å¼éŒ¯èª¤æˆ–å·²æå£',
                noCopyContent: 'æ²’æœ‰å¯è¤‡è£½çš„å…§å®¹',
                copySuccess: 'âœ“ å·²è¤‡è£½',
                copyFallback: 'å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿'
            },
            'en': {
                title: 'ğŸ” Secure Encryption Tool',
                subtitle: 'AES-GCM-256 + PBKDF2-SHA512 (600k iterations) + HKDF',
                securityBadge: 'âœ“ Zero Dependencies | âœ“ Fully Offline | âœ“ Client-Side',
                encryptTab: 'Encrypt',
                decryptTab: 'Decrypt',
                contentLabel: 'Content',
                contentPlaceholder: 'Enter text to encrypt...',
                contentPlaceholderDecrypt: 'Paste ciphertext to decrypt...',
                passwordLabel: 'Password',
                passwordPlaceholder: 'Enter strong password (16+ characters recommended)',
                togglePasswordShow: 'Show',
                togglePasswordHide: 'Hide',
                passwordHint: 'Recommended: 12+ characters with uppercase, lowercase, numbers, symbols',
                passwordHintDecrypt: 'Enter the password used for encryption',
                actionButtonEncrypt: 'ğŸ”’ Encrypt',
                actionButtonDecrypt: 'ğŸ”“ Decrypt',
                clearButton: 'Clear',
                loadingText: 'Processing...',
                loadingTextEncrypt: 'Encrypting...',
                loadingTextDecrypt: 'Decrypting...',
                outputLabel: 'Result',
                outputLabelEncrypt: 'Encrypted Result',
                outputLabelDecrypt: 'Decrypted Result',
                outputLabelError: 'Error',
                outputEmpty: 'Result will be displayed here...',
                copyButton: 'ğŸ“‹ Copy Result',
                infoTitle: 'âš ï¸ Security Notice',
                infoContent: 'â€¢ All encryption is performed locally in your browser and never sent to any server<br>â€¢ Please keep your password safe - lost passwords cannot recover data<br>â€¢ Uses AES-GCM-256 encryption with PBKDF2-SHA512 (600,000 iterations) key derivation<br>â€¢ Strong passwords are recommended for best security',
                footerLine1: '100% Native JavaScript | Zero Dependencies | Open Source',
                // Error messages
                errorNoContent: 'Please enter content to encrypt',
                errorNoCiphertext: 'Please enter ciphertext to decrypt',
                errorNoPassword: 'Please enter password',
                errorPasswordTooShort: 'Password must be at least 8 characters (16+ recommended)',
                errorEncryptionFailed: 'Encryption failed. Please check your input',
                errorInvalidFormat: 'Invalid ciphertext format',
                errorDecryptionFailed: 'Decryption failed: Wrong password or corrupted ciphertext',
                errorInvalidCiphertext: 'Invalid or corrupted ciphertext format',
                noCopyContent: 'No content to copy',
                copySuccess: 'âœ“ Copied',
                copyFallback: 'Copied to clipboard'
            }
        };

        // ç•¶å‰èªè¨€ï¼ˆé»˜èªç‚ºç¹é«”ä¸­æ–‡ï¼Œæˆ–å¾ localStorage è®€å–ï¼‰
        let currentLang = localStorage.getItem('aes-vault-lang') || 
                          (navigator.language.startsWith('zh') ? 'zh-TW' : 'en');

        // ============================================
        // èªè¨€åˆ‡æ›å‡½æ•¸
        // ============================================
        function switchLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('aes-vault-lang', lang);

            // æ›´æ–° HTML lang å±¬æ€§
            document.documentElement.lang = lang;

            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.getElementById('lang-zh').classList.toggle('active', lang === 'zh-TW');
            document.getElementById('lang-en').classList.toggle('active', lang === 'en');

            // æ›´æ–°æ‰€æœ‰ç¿»è­¯æ–‡æœ¬
            updateTranslations();
        }

        function updateTranslations() {
            const t = translations[currentLang];

            // æ›´æ–°æ‰€æœ‰ data-i18n å…ƒç´ 
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) {
                    el.textContent = t[key];
                }
            });

            // æ›´æ–°æ‰€æœ‰ data-i18n-html å…ƒç´ ï¼ˆæ”¯æŒ HTMLï¼‰
            document.querySelectorAll('[data-i18n-html]').forEach(el => {
                const key = el.getAttribute('data-i18n-html');
                if (t[key]) {
                    el.innerHTML = t[key];
                }
            });

            // æ›´æ–°æ‰€æœ‰ placeholder
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (t[key]) {
                    el.placeholder = t[key];
                }
            });

            // æ ¹æ“šç•¶å‰æ¨¡å¼æ›´æ–°ç‰¹å®šæ–‡æœ¬
            updateModeSpecificTexts();
        }

        function updateModeSpecificTexts() {
            const t = translations[currentLang];
            const contentInput = document.getElementById('content-input');
            const passwordHint = document.getElementById('password-hint');

            if (currentMode === 'encrypt') {
                contentInput.placeholder = t.contentPlaceholder;
                passwordHint.textContent = t.passwordHint;
            } else {
                contentInput.placeholder = t.contentPlaceholderDecrypt;
                passwordHint.textContent = t.passwordHintDecrypt;
            }
        }

        // ============================================
        // å¸¸æ•¸å®šç¾©
        // ============================================
        const CONFIG = {
            VERSION: 0x01,
            SALT_SIZE: 32,
            IV_SIZE: 12,
            PBKDF2_ITERATIONS: 600000,
            AES_KEY_SIZE: 256,
            HASH_ALGORITHM: 'SHA-512',
            HKDF_HASH: 'SHA-256'
        };

        // ç•¶å‰æ¨¡å¼ï¼ˆencrypt æˆ– decryptï¼‰
        let currentMode = 'encrypt';

        // ============================================
        // Base64 ç·¨ç¢¼/è§£ç¢¼ (è™•ç† Unicode)
        // ============================================
        function arrayBufferToBase64(buffer) {
            const bytes = new Uint8Array(buffer);
            let binary = '';
            for (let i = 0; i < bytes.length; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            return btoa(binary);
        }

        function base64ToArrayBuffer(base64) {
            const binary = atob(base64);
            const bytes = new Uint8Array(binary.length);
            for (let i = 0; i < binary.length; i++) {
                bytes[i] = binary.charCodeAt(i);
            }
            return bytes.buffer;
        }

        // ============================================
        // HKDF-SHA256 å¯¦ä½œ
        // ============================================
        async function hkdf(ikm, length, salt = null, info = '') {
            // HKDF-Extract
            const saltKey = await crypto.subtle.importKey(
                'raw',
                salt || new Uint8Array(32),
                { name: 'HMAC', hash: CONFIG.HKDF_HASH },
                false,
                ['sign']
            );

            const prk = await crypto.subtle.sign('HMAC', saltKey, ikm);

            // HKDF-Expand
            const prkKey = await crypto.subtle.importKey(
                'raw',
                prk,
                { name: 'HMAC', hash: CONFIG.HKDF_HASH },
                false,
                ['sign']
            );

            const infoBytes = new TextEncoder().encode(info);
            const hashLen = 32; // SHA-256 è¼¸å‡º 32 bytes
            const n = Math.ceil(length / hashLen);

            let t = new Uint8Array(0);
            let okm = new Uint8Array(0);

            for (let i = 0; i < n; i++) {
                const data = new Uint8Array(t.length + infoBytes.length + 1);
                data.set(t);
                data.set(infoBytes, t.length);
                data[data.length - 1] = i + 1;

                t = new Uint8Array(await crypto.subtle.sign('HMAC', prkKey, data));

                const newOkm = new Uint8Array(okm.length + t.length);
                newOkm.set(okm);
                newOkm.set(t, okm.length);
                okm = newOkm;
            }

            return okm.slice(0, length);
        }

        // ============================================
        // UI æ§åˆ¶å‡½æ•¸
        // ============================================
        function switchMode(mode) {
            currentMode = mode;
            const t = translations[currentLang];

            const encryptTab = document.getElementById('encrypt-tab');
            const decryptTab = document.getElementById('decrypt-tab');
            const contentInput = document.getElementById('content-input');
            const passwordHint = document.getElementById('password-hint');
            const actionButton = document.getElementById('action-button');

            if (mode === 'encrypt') {
                encryptTab.classList.add('active');
                decryptTab.classList.remove('active');
                contentInput.placeholder = t.contentPlaceholder;
                passwordHint.textContent = t.passwordHint;
                actionButton.textContent = t.actionButtonEncrypt;
            } else {
                encryptTab.classList.remove('active');
                decryptTab.classList.add('active');
                contentInput.placeholder = t.contentPlaceholderDecrypt;
                passwordHint.textContent = t.passwordHintDecrypt;
                actionButton.textContent = t.actionButtonDecrypt;
            }

            // æ¸…é™¤è¼¸å‡º
            hideOutput();
        }

        function hideOutput() {
            const outputSection = document.getElementById('output-section');
            outputSection.style.display = 'none';
        }

        function showOutput(content, type = 'success') {
            const t = translations[currentLang];
            const outputSection = document.getElementById('output-section');
            const outputDiv = document.getElementById('output');
            const outputLabel = document.getElementById('output-label');

            outputSection.style.display = 'block';

            if (type === 'success') {
                outputDiv.textContent = content;
                outputDiv.className = 'output-area success';
                outputLabel.textContent = currentMode === 'encrypt' ? t.outputLabelEncrypt : t.outputLabelDecrypt;
            } else {
                outputDiv.textContent = 'âŒ ' + content;
                outputDiv.className = 'output-area error';
                outputLabel.textContent = t.outputLabelError;
            }

            // å¹³æ»‘æ»¾å‹•åˆ°çµæœ
            setTimeout(() => {
                outputSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
        }

        // ============================================
        // å¯†ç¢¼å¼·åº¦æª¢æ¸¬
        // ============================================
        function checkPasswordStrength(password) {
            const strengthBar = document.getElementById('password-strength-bar');

            if (!password || currentMode === 'decrypt') {
                strengthBar.className = 'password-strength-bar';
                return;
            }

            let strength = 0;

            // é•·åº¦æª¢æŸ¥
            if (password.length >= 8) strength++;
            if (password.length >= 12) strength++;
            if (password.length >= 16) strength++;

            // è¤‡é›œåº¦æª¢æŸ¥
            if (/[a-z]/.test(password)) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^a-zA-Z0-9]/.test(password)) strength++;

            // è¨­å®šå¼·åº¦é¡¯ç¤º
            strengthBar.className = 'password-strength-bar';
            if (strength <= 3) {
                strengthBar.classList.add('strength-weak');
            } else if (strength <= 5) {
                strengthBar.classList.add('strength-medium');
            } else {
                strengthBar.classList.add('strength-strong');
            }
        }

        // ============================================
        // å¯†ç¢¼é¡¯ç¤º/éš±è—åˆ‡æ›
        // ============================================
        function togglePassword() {
            const t = translations[currentLang];
            const input = document.getElementById('password-input');
            const button = input.nextElementSibling;

            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = t.togglePasswordHide;
            } else {
                input.type = 'password';
                button.textContent = t.togglePasswordShow;
            }
        }

        // ============================================
        // ä¸»è¦è™•ç†å‡½æ•¸ï¼ˆæ ¹æ“šæ¨¡å¼åŸ·è¡ŒåŠ å¯†æˆ–è§£å¯†ï¼‰
        // ============================================
        async function processAction() {
            if (currentMode === 'encrypt') {
                await encryptData();
            } else {
                await decryptData();
            }
        }

        // ============================================
        // æ ¸å¿ƒåŠ å¯†å‡½æ•¸
        // ============================================
        async function encryptData() {
            const t = translations[currentLang];
            const content = document.getElementById('content-input').value;
            const password = document.getElementById('password-input').value;
            const loading = document.getElementById('loading');
            const loadingText = document.getElementById('loading-text');

            // é©—è­‰è¼¸å…¥
            if (!content) {
                showOutput(t.errorNoContent, 'error');
                return;
            }

            if (!password) {
                showOutput(t.errorNoPassword, 'error');
                return;
            }

            if (password.length < 8) {
                showOutput(t.errorPasswordTooShort, 'error');
                return;
            }

            try {
                loading.classList.add('active');
                loadingText.textContent = t.loadingTextEncrypt;
                hideOutput();

                // å»¶é²åŸ·è¡Œä»¥é¡¯ç¤º loading å‹•ç•«
                await new Promise(resolve => setTimeout(resolve, 100));

                // 1. ç”Ÿæˆéš¨æ©Ÿ Salt å’Œ IV
                const salt = crypto.getRandomValues(new Uint8Array(CONFIG.SALT_SIZE));
                const iv = crypto.getRandomValues(new Uint8Array(CONFIG.IV_SIZE));

                // 2. ä½¿ç”¨ PBKDF2-SHA512 å¾å¯†ç¢¼è¡ç”Ÿä¸­é–“é‡‘é‘°
                const passwordBytes = new TextEncoder().encode(password);
                const passwordKey = await crypto.subtle.importKey(
                    'raw',
                    passwordBytes,
                    'PBKDF2',
                    false,
                    ['deriveBits']
                );

                const intermediateKeyBits = await crypto.subtle.deriveBits(
                    {
                        name: 'PBKDF2',
                        salt: salt,
                        iterations: CONFIG.PBKDF2_ITERATIONS,
                        hash: CONFIG.HASH_ALGORITHM
                    },
                    passwordKey,
                    256
                );

                // 3. ä½¿ç”¨ HKDF è¡ç”Ÿæœ€çµ‚ AES é‡‘é‘°
                const finalKeyBytes = await hkdf(
                    new Uint8Array(intermediateKeyBits),
                    32,
                    salt,
                    'AES-GCM-256-Encryption-Key'
                );

                const aesKey = await crypto.subtle.importKey(
                    'raw',
                    finalKeyBytes,
                    { name: 'AES-GCM' },
                    false,
                    ['encrypt']
                );

                // 4. åŠ å¯†æ˜æ–‡
                const plaintextBytes = new TextEncoder().encode(content);
                const ciphertext = await crypto.subtle.encrypt(
                    {
                        name: 'AES-GCM',
                        iv: iv,
                        tagLength: 128
                    },
                    aesKey,
                    plaintextBytes
                );

                // 5. çµ„åˆè¼¸å‡º: version(1) + salt(32) + iv(12) + ciphertext
                const output = new Uint8Array(1 + CONFIG.SALT_SIZE + CONFIG.IV_SIZE + ciphertext.byteLength);
                output[0] = CONFIG.VERSION;
                output.set(salt, 1);
                output.set(iv, 1 + CONFIG.SALT_SIZE);
                output.set(new Uint8Array(ciphertext), 1 + CONFIG.SALT_SIZE + CONFIG.IV_SIZE);

                // 6. è½‰æ›ç‚º Base64
                const base64Output = arrayBufferToBase64(output);

                showOutput(base64Output, 'success');

            } catch (error) {
                console.error('åŠ å¯†éŒ¯èª¤:', error);
                showOutput(t.errorEncryptionFailed, 'error');
            } finally {
                loading.classList.remove('active');
            }
        }

        // ============================================
        // æ ¸å¿ƒè§£å¯†å‡½æ•¸
        // ============================================
        async function decryptData() {
            const t = translations[currentLang];
            const content = document.getElementById('content-input').value.trim();
            const password = document.getElementById('password-input').value;
            const loading = document.getElementById('loading');
            const loadingText = document.getElementById('loading-text');

            // é©—è­‰è¼¸å…¥
            if (!content) {
                showOutput(t.errorNoCiphertext, 'error');
                return;
            }

            if (!password) {
                showOutput(t.errorNoPassword, 'error');
                return;
            }

            try {
                loading.classList.add('active');
                loadingText.textContent = t.loadingTextDecrypt;
                hideOutput();

                // å»¶é²åŸ·è¡Œä»¥é¡¯ç¤º loading å‹•ç•«
                await new Promise(resolve => setTimeout(resolve, 100));

                // 1. è§£æ Base64
                let encryptedData;
                try {
                    encryptedData = new Uint8Array(base64ToArrayBuffer(content));
                } catch (e) {
                    throw new Error(t.errorInvalidFormat);
                }

                // 2. æª¢æŸ¥ç‰ˆæœ¬å’Œæœ€å°é•·åº¦
                const minLength = 1 + CONFIG.SALT_SIZE + CONFIG.IV_SIZE + 16; // 16 = æœ€å° GCM tag
                if (encryptedData.length < minLength) {
                    throw new Error(t.errorInvalidCiphertext);
                }

                const version = encryptedData[0];
                if (version !== CONFIG.VERSION) {
                    throw new Error(t.errorInvalidCiphertext);
                }

                // 3. æå– Salt, IV, Ciphertext
                const salt = encryptedData.slice(1, 1 + CONFIG.SALT_SIZE);
                const iv = encryptedData.slice(1 + CONFIG.SALT_SIZE, 1 + CONFIG.SALT_SIZE + CONFIG.IV_SIZE);
                const ciphertextBytes = encryptedData.slice(1 + CONFIG.SALT_SIZE + CONFIG.IV_SIZE);

                // 4. ä½¿ç”¨ç›¸åŒåƒæ•¸å¾å¯†ç¢¼è¡ç”Ÿä¸­é–“é‡‘é‘°
                const passwordBytes = new TextEncoder().encode(password);
                const passwordKey = await crypto.subtle.importKey(
                    'raw',
                    passwordBytes,
                    'PBKDF2',
                    false,
                    ['deriveBits']
                );

                const intermediateKeyBits = await crypto.subtle.deriveBits(
                    {
                        name: 'PBKDF2',
                        salt: salt,
                        iterations: CONFIG.PBKDF2_ITERATIONS,
                        hash: CONFIG.HASH_ALGORITHM
                    },
                    passwordKey,
                    256
                );

                // 5. ä½¿ç”¨ HKDF è¡ç”Ÿæœ€çµ‚ AES é‡‘é‘°
                const finalKeyBytes = await hkdf(
                    new Uint8Array(intermediateKeyBits),
                    32,
                    salt,
                    'AES-GCM-256-Encryption-Key'
                );

                const aesKey = await crypto.subtle.importKey(
                    'raw',
                    finalKeyBytes,
                    { name: 'AES-GCM' },
                    false,
                    ['decrypt']
                );

                // 6. è§£å¯†
                const decryptedBytes = await crypto.subtle.decrypt(
                    {
                        name: 'AES-GCM',
                        iv: iv,
                        tagLength: 128
                    },
                    aesKey,
                    ciphertextBytes
                );

                // 7. è½‰æ›ç‚ºæ–‡å­—
                const plaintext = new TextDecoder().decode(decryptedBytes);

                showOutput(plaintext, 'success');

            } catch (error) {
                console.error('è§£å¯†éŒ¯èª¤:', error);

                // ä¸é€éœ²å…·é«”éŒ¯èª¤ç´°ç¯€ï¼Œæå‡å®‰å…¨æ€§
                if (error.name === 'OperationError' || error.message.includes('decrypt')) {
                    showOutput(t.errorDecryptionFailed, 'error');
                } else {
                    showOutput(error.message || t.errorInvalidCiphertext, 'error');
                }
            } finally {
                loading.classList.remove('active');
            }
        }

        // ============================================
        // UI è¼”åŠ©å‡½æ•¸
        // ============================================
        function clearAll() {
            document.getElementById('content-input').value = '';
            document.getElementById('password-input').value = '';
            document.getElementById('password-strength-bar').className = 'password-strength-bar';
            hideOutput();
        }

        async function copyToClipboard() {
            const t = translations[currentLang];
            const output = document.getElementById('output');
            const text = output.textContent;

            if (!text || text.includes(t.outputEmpty) || text.includes(t.loadingText) || text.startsWith('âŒ')) {
                alert(t.noCopyContent);
                return;
            }

            try {
                await navigator.clipboard.writeText(text);

                // é¡¯ç¤ºè¤‡è£½æˆåŠŸæç¤º
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = t.copySuccess;
                button.style.background = '#45a049';

                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '';
                }, 2000);
            } catch (err) {
                // Fallback æ–¹æ³•
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert(t.copyFallback);
            }
        }

        // ============================================
        // äº‹ä»¶ç›£è½å™¨
        // ============================================
        document.getElementById('password-input').addEventListener('input', function(e) {
            checkPasswordStrength(e.target.value);
        });

        // æŒ‰ Enter éµè§¸ç™¼è™•ç†
        document.getElementById('password-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                processAction();
            }
        });

        document.getElementById('content-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                processAction();
            }
        });

        // ============================================
        // åˆå§‹åŒ–
        // ============================================
        // åˆå§‹åŒ–èªè¨€
        document.addEventListener('DOMContentLoaded', function() {
            switchLanguage(currentLang);
        });

        console.log('ğŸ” é«˜å®‰å…¨æ€§åŠ è§£å¯†å·¥å…·å·²è¼‰å…¥');
        console.log('ç‰ˆæœ¬:', CONFIG.VERSION);
        console.log('åŠ å¯†æ¼”ç®—æ³•: AES-GCM-256');
        console.log('é‡‘é‘°è¡ç”Ÿ: PBKDF2-SHA512 (' + CONFIG.PBKDF2_ITERATIONS.toLocaleString() + ' iterations) + HKDF-SHA256');
        console.log('é›¶å¤–éƒ¨ä¾è³´ | å®Œå…¨é›¢ç·šå¯ç”¨ | å®¢æˆ¶ç«¯åŠ å¯†');
    </script>
</body>
</html>
